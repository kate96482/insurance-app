<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>退休缺口與四種方案試算</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #DE6262; --secondary: #FFB88C; --text: #4A3728; --bg: #FDFBF7; --success: #2F855A; --accent: #e67e22; --female: #ed6ea0; }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background: #F0EDE9; margin: 0; padding: 15px; color: var(--text); }
        .container { max-width: 480px; margin: auto; }
        
        /* 導覽列樣式 */
        .nav-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .nav-link { text-decoration: none; color: var(--text); font-size: 0.9rem; font-weight: bold; display: flex; align-items: center; gap: 5px; background: rgba(255,255,255,0.5); padding: 5px 12px; border-radius: 20px; transition: 0.3s; }
        .nav-link:active { background: #fff; }

        .card { background: white; padding: 25px; border-radius: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.05); margin-bottom: 20px; }
        h2 { color: var(--primary); margin-top: 0; font-size: 1.4rem; text-align: center; }
        .input-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.85rem; font-weight: bold; margin-bottom: 5px; color: var(--primary); }
        input, select { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #E8E2D9; box-sizing: border-box; font-size: 1rem; outline: none; }
        input:focus { border-color: var(--secondary); }
        
        .gender-group { display: flex; gap: 10px; margin-bottom: 15px; }
        .gender-btn { flex: 1; padding: 10px; border: 1px solid #E8E2D9; border-radius: 10px; background: white; cursor: pointer; text-align: center; font-weight: bold; transition: 0.3s; }
        .gender-btn.male.active { background: var(--primary); color: white; border-color: var(--primary); }
        .gender-btn.female.active { background: var(--female); color: white; border-color: var(--female); }
        
        .btn { width: 100%; padding: 15px; background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; border: none; border-radius: 12px; font-weight: bold; font-size: 1.1rem; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        .btn:active { transform: scale(0.98); opacity: 0.9; }
        
        #result-area { display: none; margin-top: 25px; }
        .gap-box { background: #FFF5F5; padding: 15px; border-radius: 15px; text-align: center; border: 1px solid #FFE3E3; margin-bottom: 20px; }
        .gap-val { font-size: 1.6rem; font-weight: bold; color: var(--accent); }
        
        .solution-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .sol-card { background: white; padding: 15px; border-radius: 15px; border: 1px solid #E8E2D9; position: relative; overflow: hidden; display: flex; flex-direction: column; justify-content: space-between; }
        .sol-tag { position: absolute; top: 0; right: 0; background: var(--primary); color: white; font-size: 0.7rem; padding: 2px 8px; border-bottom-left-radius: 10px; }
        .sol-title { font-weight: bold; font-size: 1rem; margin-bottom: 5px; color: #333; }
        .sol-rate { font-size: 0.8rem; color: var(--success); font-weight: bold; }
        
        /* 修改：縮小字體並強制不換行，確保一列呈現 */
        .sol-monthly { font-size: 1.1rem; font-weight: bold; color: var(--text); margin: 8px 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .sol-yearly { font-size: 0.75rem; color: #888; line-height: 1.4; }
    </style>
</head>
<body>

<div class="container">
    <div class="nav-top">
        <a href="labor_calc.html" class="nav-link"><i class="fa-solid fa-chevron-left"></i> 返回試算</a>
        <a href="index.html" class="nav-link"><i class="fa-solid fa-house"></i> 首頁</a>
    </div>

    <div class="card">
        <h2>退休缺口方案對照</h2>
        
        <div class="input-group">
            <label>性別</label>
            <div class="gender-group" id="gender-selector">
                <div class="gender-btn male active" id="btn-male" onclick="setGender('male')">男性</div>
                <div class="gender-btn female" id="btn-female" onclick="setGender('female')">女性</div>
            </div>
        </div>

        <div style="display: flex; gap: 10px;">
            <div class="input-group" style="flex: 1;">
                <label>目前年齡</label>
                <input type="number" id="current-age" value="30" min="0" max="65">
            </div>
            <div class="input-group" style="flex: 1;">
                <label>預計領息年齡</label>
                <select id="retire-age">
                    <option value="55">55 歲</option>
                    <option value="60">60 歲</option>
                    <option value="65" selected>65 歲</option>
                </select>
            </div>
        </div>

        <div class="input-group">
            <label>理想退休月領 (元)</label>
            <input type="number" id="dream-income" value="50000" step="1000">
        </div>

        <div class="input-group">
            <label>勞保月領預估 (可參考勞保計算機)</label>
            <input type="number" id="labor-income" value="22000" step="1000">
        </div>

        <div style="display: flex; gap: 10px;">
            <div class="input-group" style="flex: 1.5;">
                <label>已累計本金 (元)</label>
                <input type="number" id="saved-capital" value="0" step="10000">
            </div>
            <div class="input-group" style="flex: 1;">
                <label>預計提領 (年)</label>
                <input type="number" id="payout-years" value="25" min="1" max="50">
            </div>
        </div>

        <button class="btn" onclick="calculateSolutions()">分析四種理財方案</button>

        <div id="result-area">
            <div class="gap-box">
                您的每月退休金缺口
                <div class="gap-val" id="res-gap">$ 0</div>
                <div id="gap-subtext" style="font-size: 0.8rem; color: #888; margin-top: 5px;">以下方案僅供參考</div>
            </div>

            <div class="solution-grid" id="solution-container"></div>
        </div>
    </div>
</div>

<script>
    let currentGender = 'male';

    function setGender(gender) {
        currentGender = gender;
        document.querySelectorAll('.gender-btn').forEach(btn => btn.classList.remove('active'));
        if(gender === 'male') {
            document.getElementById('btn-male').classList.add('active');
        } else {
            document.getElementById('btn-female').classList.add('active');
        }
    }

    const rateDataMale = {
    "3": {
        "55": {0:35.5, 1:34.1, 2:32.7, 3:31.3, 4:30.0, 5:28.8, 6:27.6, 7:26.5, 8:25.4, 9:24.3, 10:23.3, 11:22.3, 12:21.4, 13:20.5, 14:19.7, 15:18.9, 16:18.1, 17:17.3, 18:16.6, 19:15.9, 20:15.3, 21:14.7, 22:14.1, 23:13.5, 24:12.5, 25:12.5, 26:11.9, 27:11.4, 28:11.0, 29:10.5, 30:10.1, 31:9.6, 32:9.3, 33:8.9, 34:8.7, 35:8.2, 36:7.8, 37:7.5, 38:7.2, 39:6.9, 40:6.6, 41:6.4, 42:6.1, 43:5.9, 44:5.7, 45:5.5, 46:5.3, 47:4.9, 48:4.6, 49:4.2},
        "60": {0:45.6, 1:43.8, 2:42.1, 3:40.2, 4:38.6, 5:37.0, 6:35.4, 7:34.0, 8:32.6, 9:31.3, 10:30.0, 11:28.7, 12:27.5, 13:26.4, 14:25.3, 15:24.3, 16:23.3, 17:22.3, 18:21.4, 19:20.5, 20:19.7, 21:18.9, 22:18.1, 23:17.4, 24:16.7, 25:16.0, 26:15.3, 27:14.7, 28:14.1, 29:13.5, 30:13.0, 31:12.4, 32:11.9, 33:11.4, 34:10.9, 35:10.5, 36:10.1, 37:9.7, 38:9.3, 39:8.9, 40:8.5, 41:8.2, 42:7.8, 43:7.5, 44:7.4, 45:7.1, 46:6.8, 47:6.4, 48:6.2, 49:5.9, 50:5.6, 51:5.3, 52:4.8, 53:4.3, 54:3.9},
        "65": {0:59.5, 1:57.0, 2:54.7, 3:52.4, 4:50.2, 5:48.1, 6:46.1, 7:44.3, 8:42.5, 9:40.7, 10:39.0, 11:37.4, 12:35.8, 13:34.4, 14:32.9, 15:31.6, 16:30.3, 17:29.0, 18:27.8, 19:26.7, 20:25.6, 21:24.6, 22:23.6, 23:22.6, 24:21.7, 25:20.8, 26:20.0, 27:19.1, 28:18.4, 29:17.6, 30:16.9, 31:16.1, 32:15.5, 33:14.9, 34:14.2, 35:13.7, 36:13.1, 37:12.6, 38:12.1, 39:11.6, 40:11.1, 41:10.6, 42:10.2, 43:9.8, 44:9.6, 45:9.2, 46:8.8, 47:8.3, 48:8.0, 49:7.7, 50:7.3, 51:7.1, 52:6.7, 53:6.4, 54:5.9, 55:5.2, 56:4.7, 57:4.2, 58:3.7, 59:3.3}
    },
    "6": {
        "55": {0:35.3, 1:33.8, 2:32.4, 3:31.0, 4:29.6, 5:28.4, 6:27.2, 7:26.1, 8:24.9, 9:23.9, 10:22.8, 11:21.8, 12:20.9, 13:20.0, 14:19.2, 15:18.4, 16:17.6, 17:16.8, 18:16.1, 19:15.4, 20:14.8, 21:14.2, 22:13.6, 23:13.0, 24:12.5, 25:12.0, 26:11.4, 27:10.9, 28:10.5, 29:10.0, 30:9.6, 31:9.2, 32:8.8, 33:8.4, 34:8.1, 35:7.7, 36:7.4, 37:7.1, 38:6.8, 39:6.5, 40:6.2, 41:6.0, 42:5.7, 43:5.5, 44:5.3, 45:5.1, 46:4.8, 47:4.6, 48:4.4, 49:4.1},
        "60": {0:45.6, 1:43.7, 2:41.9, 3:40.0, 4:38.3, 5:36.7, 6:35.2, 7:33.7, 8:32.2, 9:30.8, 10:29.6, 11:28.2, 12:27.0, 13:25.9, 14:24.8, 15:23.8, 16:22.7, 17:21.8, 18:20.8, 19:19.9, 20:19.1, 21:18.3, 22:17.5, 23:16.8, 24:16.1, 25:15.4, 26:14.8, 27:14.1, 28:13.5, 29:13.0, 30:12.4, 31:11.9, 32:11.3, 33:10.9, 34:10.4, 35:10.0, 36:9.5, 37:9.1, 38:8.8, 39:8.4, 40:8.1, 41:7.7, 42:7.4, 43:7.1, 44:6.8, 45:6.5, 46:6.3, 47:5.9, 48:5.7, 49:5.5, 50:5.2, 51:5.0, 52:4.7, 53:4.6, 54:4.3},
        "65": {0:59.7, 1:57.2, 2:54.8, 3:52.4, 4:50.2, 5:48.0, 6:46.1, 7:44.1, 8:42.2, 9:40.4, 10:38.6, 11:37.0, 12:35.4, 13:33.9, 14:32.4, 15:31.1, 16:29.7, 17:28.5, 18:27.3, 19:26.1, 20:25.6, 21:24.0, 22:23.0, 23:22.0, 24:21.0, 25:20.2, 26:19.3, 27:18.5, 28:17.7, 29:17.0, 30:16.2, 31:15.5, 32:14.9, 33:14.2, 34:13.6, 35:13.0, 36:12.5, 37:12.0, 38:11.5, 39:11.0, 40:10.5, 41:10.1, 42:9.7, 43:9.2, 44:8.9, 45:8.6, 46:8.2, 47:7.8, 48:7.5, 49:7.2, 50:6.8, 51:6.6, 52:6.2, 53:6.1, 54:5.6, 55:5.3, 56:4.7, 57:4.1, 58:3.6, 59:3.2}
    },
    "10": {
        "55": {0:25.9, 1:24.8, 2:23.8, 3:22.9, 4:22.0, 5:21.1, 6:20.2, 7:19.6, 8:19.0, 9:18.4, 10:17.2, 11:16.6, 12:16.0, 13:15.4, 14:14.8, 15:14.0, 16:13.5, 17:13.0, 18:12.5, 19:12.0, 20:11.5, 21:11.1, 22:10.7, 23:10.3, 24:9.8, 25:9.4, 26:9.1, 27:8.7, 28:8.4, 29:8.0, 30:7.7, 31:7.4, 32:7.1, 33:6.8, 34:6.6, 35:6.3, 36:6.0, 37:5.7, 38:5.3, 39:5.0, 40:4.6, 41:4.3, 42:3.9, 43:3.6, 44:3.2, 45:2.9},
        "60": {0:33.1, 1:31.8, 2:30.5, 3:29.3, 4:28.1, 5:27.0, 6:25.9, 7:25.1, 8:24.1, 9:23.0, 10:22.0, 11:21.2, 12:20.4, 13:19.6, 14:18.8, 15:18.0, 16:17.3, 17:16.7, 18:16.0, 19:15.4, 20:14.7, 21:14.2, 22:13.6, 23:13.1, 24:12.5, 25:12.0, 26:11.6, 27:11.1, 28:10.7, 29:10.2, 30:9.8, 31:9.4, 32:9.1, 33:8.7, 34:8.4, 35:8.0, 36:7.7, 37:7.4, 38:7.1, 39:6.8, 40:6.5, 41:6.1, 42:5.6, 43:5.2, 44:4.7, 45:4.3, 46:4.0, 47:3.6, 48:3.3, 49:2.9, 50:2.6},
        "65": {0:43.0, 1:41.3, 2:39.6, 3:38.0, 4:36.5, 5:35.1, 6:33.7, 7:32.6, 8:31.3, 9:30.0, 10:28.6, 11:27.6, 12:26.5, 13:25.5, 14:24.4, 15:23.4, 16:22.5, 17:21.7, 18:20.8, 19:20.0, 20:19.1, 21:18.4, 22:17.7, 23:17.0, 24:16.3, 25:15.6, 26:15.0, 27:14.4, 28:13.8, 29:13.3, 30:12.7, 31:12.2, 32:11.8, 33:11.3, 34:10.9, 35:10.0, 36:9.7, 37:9.4, 38:9.1, 39:8.8, 40:8.5, 41:8.1, 42:7.7, 43:7.2, 44:6.8, 45:6.4, 46:6.0, 47:5.6, 48:5.2, 49:4.8, 50:4.4, 51:4.1, 52:3.8, 53:3.4, 54:3.1, 55:2.8}
    },
    "20": {
        "55": {0:21.2, 1:20.3, 2:19.5, 3:18.8, 4:18.1, 5:17.3, 6:16.7, 7:16.0, 8:15.4, 9:14.7, 10:14.1, 11:13.6, 12:13.1, 13:12.5, 14:12.0, 15:11.5, 16:11.1, 17:10.7, 18:10.2, 19:9.8, 20:9.4, 21:9.1, 22:8.7, 23:8.4, 24:8.0, 25:7.7, 26:7.4, 27:7.1, 28:6.8, 29:6.6, 30:6.3, 31:6.0, 32:5.7, 33:5.4, 34:5.1, 35:4.8},
        "60": {0:27.3, 1:26.2, 2:25.1, 3:24.1, 4:23.2, 5:22.3, 6:21.5, 7:20.6, 8:19.8, 9:19.0, 10:18.2, 11:17.5, 12:16.8, 13:16.1, 14:15.5, 15:14.8, 16:14.3, 17:13.7, 18:13.2, 19:12.6, 20:12.1, 21:11.7, 22:11.2, 23:10.8, 24:10.3, 25:9.9, 26:9.5, 27:9.2, 28:8.8, 29:8.5, 30:8.1, 31:7.8, 32:7.5, 33:7.2, 34:6.9, 35:6.6, 36:6.1, 37:5.7, 38:5.2, 39:4.8, 40:4.3},
        "65": {0:35.5, 1:34.1, 2:32.7, 3:31.4, 4:30.1, 5:28.9, 6:27.8, 7:26.7, 8:25.7, 9:24.6, 10:23.6, 11:22.7, 12:21.9, 13:21.0, 14:20.2, 15:19.4, 16:18.7, 17:17.9, 18:17.2, 19:16.5, 20:15.8, 21:15.3, 22:14.8, 23:14.2, 24:13.7, 25:13.2, 26:12.7, 27:12.1, 28:11.6, 29:11.1, 30:10.6, 31:10.2, 32:9.8, 33:9.5, 34:9.1, 35:8.7, 36:8.4, 37:8.1, 38:7.9, 39:7.6, 40:7.4, 41:6.8, 42:6.2, 43:5.6, 44:5.0, 45:4.4}
    }
};

const rateDataFemale = {
    "3": {
        "55": {0:36.3, 1:34.8, 2:33.4, 3:32.0, 4:30.7, 5:29.4, 6:28.2, 7:27.1, 8:25.9, 9:24.9, 10:23.8, 11:22.8, 12:21.9, 13:21.0, 14:20.1, 15:19.3, 16:18.5, 17:17.7, 18:17.0, 19:16.3, 20:15.6, 21:15.0, 22:14.4, 23:13.8, 24:13.3, 25:12.7, 26:12.2, 27:11.7, 28:11.2, 29:10.7, 30:10.3, 31:9.8, 32:9.4, 33:9.0, 34:8.7, 35:8.3, 36:8.0, 37:7.6, 38:7.3, 39:7.0, 40:6.7, 41:6.5, 42:6.2, 43:5.9, 44:5.8, 45:5.6, 46:5.3, 47:5.0, 48:4.8, 49:4.3},
        "60": {0:46.8, 1:44.9, 2:43.1, 3:41.2, 4:39.5, 5:37.9, 6:36.4, 7:34.9, 8:33.4, 9:32.0, 10:30.7, 11:29.4, 12:28.2, 13:27.0, 14:25.9, 15:24.9, 16:23.8, 17:22.8, 18:21.9, 19:21.0, 20:20.1, 21:19.3, 22:18.5, 23:17.7, 24:17.0, 25:16.3, 26:15.7, 27:15.0, 28:14.4, 29:13.8, 30:13.2, 31:12.7, 32:12.1, 33:11.6, 34:11.2, 35:10.7, 36:10.3, 37:9.8, 38:9.4, 39:9.0, 40:8.7, 41:8.3, 42:8.0, 43:7.6, 44:7.5, 45:7.2, 46:6.9, 47:6.5, 48:6.2, 49:6.0, 50:5.7, 51:5.5, 52:5.3, 53:4.8, 54:4.4},
        "65": {0:61.0, 1:58.5, 2:56.2, 3:53.8, 4:51.5, 5:49.4, 6:47.4, 7:45.5, 8:43.6, 9:41.8, 10:40.1, 11:38.4, 12:36.8, 13:35.2, 14:33.8, 15:31.9, 16:31.1, 17:29.8, 18:28.5, 19:27.4, 20:26.3, 21:25.2, 22:24.1, 23:23.2, 24:22.2, 25:21.3, 26:20.4, 27:19.6, 28:18.8, 29:18.0, 30:17.3, 31:16.5, 32:15.8, 33:15.2, 34:14.5, 35:14.0, 36:13.4, 37:12.8, 38:12.3, 39:11.8, 40:11.3, 41:10.8, 42:10.4, 43:10.0, 44:9.8, 45:9.4, 46:9.0, 47:8.4, 48:8.1, 49:7.8, 50:7.4, 51:7.2, 52:6.8, 53:6.5, 54:6.2, 55:5.9, 56:5.5, 57:5.0, 58:4.6, 59:4.2}
    },
    "6": {
        "55": {0:36.1, 1:34.6, 2:33.2, 3:31.7, 4:30.4, 5:29.0, 6:27.8, 7:26.7, 8:25.5, 9:24.4, 10:23.4, 11:22.3, 12:21.4, 13:20.5, 14:19.6, 15:18.8, 16:18.0, 17:17.2, 18:16.5, 19:15.8, 20:15.1, 21:14.5, 22:13.9, 23:13.3, 24:12.7, 25:12.2, 26:11.6, 27:11.1, 28:10.7, 29:10.2, 30:9.8, 31:9.3, 32:8.9, 33:8.6, 34:8.2, 35:7.8, 36:7.5, 37:7.2, 38:6.9, 39:6.6, 40:6.2, 41:6.1, 42:5.8, 43:5.5, 44:5.4, 45:5.1, 46:4.9, 47:4.6, 48:4.4, 49:4.2},
        "60": {0:46.8, 1:44.8, 2:42.9, 3:41.0, 4:39.3, 5:37.6, 6:36.1, 7:34.5, 8:33.0, 9:31.6, 10:30.3, 11:28.9, 12:27.7, 13:26.5, 14:25.4, 15:24.3, 16:23.3, 17:22.3, 18:21.3, 19:20.4, 20:19.6, 21:18.7, 22:17.9, 23:17.2, 24:16.4, 25:15.7, 26:15.1, 27:14.4, 28:13.8, 29:13.2, 30:12.7, 31:12.1, 32:11.6, 33:11.1, 34:10.6, 35:10.2, 36:9.7, 37:9.3, 38:9.0, 39:8.5, 40:8.1, 41:7.8, 42:7.5, 43:7.2, 44:6.9, 45:6.6, 46:6.4, 47:6.0, 48:5.8, 49:5.5, 50:5.3, 51:5.0, 52:4.8, 53:4.6, 54:4.2},
        "65": {0:61.4, 1:58.8, 2:56.4, 3:53.8, 4:52.0, 5:49.3, 6:47.3, 7:45.3, 8:43.3, 9:41.5, 10:39.7, 11:37.9, 12:36.3, 13:34.8, 14:33.3, 15:31.9, 16:30.5, 17:29.2, 18:27.9, 19:26.7, 20:25.6, 21:24.6, 22:23.5, 23:22.5, 24:21.6, 25:20.6, 26:19.8, 27:19.0, 28:18.1, 29:17.4, 30:16.6, 31:15.9, 32:15.2, 33:14.5, 34:13.9, 35:13.3, 36:12.8, 37:12.2, 38:11.9, 39:11.2, 40:10.5, 41:10.3, 42:9.8, 43:9.4, 44:9.1, 45:8.7, 46:8.3, 47:7.9, 48:7.6, 49:7.2, 50:6.9, 51:6.6, 52:6.3, 53:6.1, 54:5.8, 55:5.5, 56:5.2, 57:4.8, 58:4.4, 59:4.0}
    },
    "10": {
        "55": {0:26.5, 1:25.4, 2:24.4, 3:23.4, 4:22.5, 5:21.6, 6:20.7, 7:19.9, 8:19.1, 9:18.3, 10:17.6, 11:16.9, 12:16.3, 13:15.6, 14:15.0, 15:14.4, 16:13.8, 17:13.3, 18:12.7, 19:12.2, 20:11.7, 21:11.2, 22:10.8, 23:10.4, 24:10.0, 25:9.6, 26:9.2, 27:8.8, 28:8.5, 29:8.1, 30:7.8, 31:7.5, 32:7.2, 33:6.9, 34:6.7, 35:6.4, 36:6.1, 37:5.8, 38:5.6, 39:5.3, 40:5.1, 41:4.8, 42:4.5, 43:4.2, 44:3.9, 45:3.5},
        "60": {0:34.0, 1:32.6, 2:31.3, 3:30.1, 4:28.9, 5:27.7, 6:26.6, 7:25.7, 8:24.7, 9:23.6, 10:22.6, 11:21.7, 12:20.8, 13:20.0, 14:19.2, 15:18.4, 16:17.7, 17:17.0, 18:16.3, 19:15.6, 20:15.0, 21:14.4, 22:13.8, 23:13.3, 24:12.8, 25:12.3, 26:11.8, 27:11.3, 28:10.8, 29:10.4, 30:10.0, 31:9.6, 32:9.2, 33:8.8, 34:8.5, 35:8.2, 36:7.8, 37:7.5, 38:7.2, 39:6.9, 40:6.7, 41:6.3, 42:6.0, 43:5.7, 44:5.3, 45:5.0, 46:4.7, 47:4.4, 48:4.1, 49:3.8, 50:3.4},
        "65": {0:44.0, 1:42.4, 2:40.7, 3:39.1, 4:37.5, 5:36.0, 6:34.6, 7:33.5, 8:32.2, 9:30.8, 10:29.4, 11:28.3, 12:27.2, 13:26.1, 14:25.0, 15:24.0, 16:23.0, 17:22.1, 18:21.2, 19:20.3, 20:19.5, 21:18.7, 22:18.0, 23:17.3, 24:16.6, 25:16.0, 26:15.3, 27:14.7, 28:14.1, 29:13.5, 30:13.0, 31:12.5, 32:12.0, 33:11.5, 34:11.1, 35:10.6, 36:10.2, 37:9.8, 38:9.4, 39:9.1, 40:8.7, 41:8.3, 42:8.0, 43:7.7, 44:7.4, 45:7.1, 46:6.6, 47:6.2, 48:5.8, 49:5.3, 50:4.9, 51:4.5, 52:4.1, 53:3.8, 54:3.5, 55:3.1}
    },
    "20": {
        "55": {0:21.6, 1:20.8, 2:20.0, 3:19.2, 4:18.5, 5:17.7, 6:17.0, 7:16.4, 8:15.7, 9:15.1, 10:14.4, 11:13.8, 12:13.3, 13:12.8, 14:12.3, 15:11.8, 16:11.3, 17:10.9, 18:10.4, 19:10.0, 20:9.6, 21:9.2, 22:8.9, 23:8.6, 24:8.3, 25:8.0, 26:7.6, 27:7.3, 28:7.0, 29:6.7, 30:6.4, 31:6.1, 32:5.8, 33:5.5, 34:5.2, 35:4.9},
        "60": {0:27.9, 1:26.8, 2:25.8, 3:24.8, 4:23.8, 5:22.8, 6:21.9, 7:21.1, 8:20.2, 9:19.4, 10:18.6, 11:17.9, 12:17.2, 13:16.5, 14:15.9, 15:15.2, 16:14.6, 17:14.0, 18:13.4, 19:12.9, 20:12.4, 21:11.9, 22:11.4, 23:11.0, 24:10.5, 25:10.1, 26:9.7, 27:9.3, 28:9.0, 29:8.6, 30:8.3, 31:7.9, 32:7.6, 33:7.3, 34:7.0, 35:6.7, 36:6.3, 37:5.9, 38:5.5, 39:5.1, 40:4.7},
        "65": {0:36.4, 1:35.0, 2:33.8, 3:32.4, 4:31.1, 5:29.8, 6:28.6, 7:27.5, 8:26.4, 9:25.3, 10:24.3, 11:23.4, 12:22.4, 13:21.5, 14:20.7, 15:19.9, 16:19.1, 17:18.3, 18:17.6, 19:16.9, 20:16.2, 21:15.5, 22:14.9, 23:14.3, 24:13.7, 25:13.2, 26:12.7, 27:12.2, 28:11.7, 29:11.3, 30:10.8, 31:10.4, 32:10.0, 33:9.6, 34:9.2, 35:8.8, 36:8.4, 37:8.1, 38:7.8, 39:7.4, 40:7.1, 41:6.7, 42:6.3, 43:5.9, 44:5.5, 45:5.2}
    }
};

   function calculateSolutions() {
        const age = parseInt(document.getElementById('current-age').value);
        const rAge = document.getElementById('retire-age').value;
        const dream = parseInt(document.getElementById('dream-income').value) || 0;
        const labor = parseInt(document.getElementById('labor-income').value) || 0;
        
        // 處理已備本金
        const savedCapital = parseInt(document.getElementById('saved-capital').value) || 0;
        const payoutYears = parseInt(document.getElementById('payout-years').value) || 25;
        
        // 將本金平攤為每月領取金額
        const monthlyFromCapital = savedCapital / (payoutYears * 12);
        
        // 最終缺口計算
        const gap = Math.max(0, dream - labor - monthlyFromCapital);
        
        document.getElementById('res-gap').innerText = `$ ${Math.round(gap).toLocaleString()}`;
        document.getElementById('result-area').style.display = 'block';

        const container = document.getElementById('solution-container');
        const gapSubtext = document.getElementById('gap-subtext');
        container.innerHTML = '';

        // 如果缺口已補足
        if (gap <= 0) {
            gapSubtext.innerText = "恭喜！您的已備資產與勞保已足以支應理想退休生活。";
            gapSubtext.style.color = "var(--success)";
            return;
        } else {
            gapSubtext.innerText = "以下方案僅供參考";
            gapSubtext.style.color = "#888";
        }

        const periods = ["3", "6", "10", "20"];
        const activeData = (currentGender === 'male') ? rateDataMale : rateDataFemale;
        const themeColor = (currentGender === 'male') ? '#DE6262' : '#ed6ea0';
        
        periods.forEach(p => {
            const ageRates = activeData[p][rAge];
            let rate = ageRates[age]; 
            
            let cardHtml = '';
            
            if (rate !== undefined && age < parseInt(rAge)) {
                const yearly = (gap * 12) / (rate / 100) / parseInt(p);
                const monthly = yearly / 12;
                // 新增：計算總存
                const totalInvest = yearly * parseInt(p);

                cardHtml = `
                    <div class="sol-card">
                        <div class="sol-tag" style="background:${themeColor}">${p}年期方案</div>
                        <div>
                            <div class="sol-title">存 ${p} 年</div>
                            <div class="sol-rate">預估領息率：${rate}%</div>
                        </div>
                        <div>
                            <div class="sol-monthly">$ ${Math.round(monthly).toLocaleString()} <small>/月</small></div>
                            <div class="sol-yearly">年存約 $${Math.round(yearly).toLocaleString()}</div>
                            <div class="sol-yearly">總累積估計 $${Math.round(totalInvest).toLocaleString()}</div>
                        </div>
                    </div>
                `;
            } else {
                cardHtml = `
                    <div class="sol-card" style="opacity:0.6; background:#f9f9f9;">
                        <div class="sol-tag" style="background:#ccc">${p}年期</div>
                        <div class="sol-title">存 ${p} 年</div>
                        <div style="margin-top:20px; font-size:0.8rem; color:#999; line-height:1.4;">
                            ${age >= parseInt(rAge) ? '目前年齡已過領息年齡' : '此年齡暫無對應費率'}
                        </div>
                    </div>
                `;
            }
            container.innerHTML += cardHtml;
        });
        
        document.getElementById('result-area').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
</script>
</body>
</html>
