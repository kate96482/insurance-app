<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <link rel="apple-touch-icon" href="logo.png">
<link rel="icon" type="image/png" href="logo.png">

<meta name="apple-mobile-web-app-title" content="å°é‚¦æ‰‹">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">

<meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MBTI æ¸¬é©— - å°é‚¦æ‰‹</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        :root {
            --primary-color: #A29BFE;
            --bg-color: #F8F9FA;
        }
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: var(--bg-color); margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        .mbti-container { width: 100%; max-width: 500px; background: white; border-radius: 25px; padding: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        
        /* é€²åº¦æ¢æ¨£å¼ */
        .progress-box { width: 100%; height: 8px; background: #eee; border-radius: 10px; margin: 15px 0; overflow: hidden; }
        #progress-bar { width: 0%; height: 100%; background: linear-gradient(90deg, #A29BFE, #6C5CE7); transition: 0.3s; }
        
        /* é¸é …æŒ‰éˆ•æ¨£å¼ */
        .options-container { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; }
        .opt-btn { border: none; padding: 15px; border-radius: 50px; font-weight: bold; cursor: pointer; transition: 0.2s; font-size: 1rem; }
        .opt-agree-3 { background-color: #D1E9FF; }
        .opt-agree-2 { background-color: #E3F2FF; }
        .opt-agree-1 { background-color: #F0F8FF; }
        .opt-neutral { background-color: #F1F3F5; color: #888; }
        .opt-disagree-1 { background-color: #FFF0F3; }
        .opt-disagree-2 { background-color: #FFDDE4; }
        .opt-disagree-3 { background-color: #FFCAD4; }

        /* çµæœåœ–å¡ */
        .result-card-design { padding: 30px 15px; text-align: center; border-radius: 20px; background: #fff; }
        #res-code { font-size: 3rem; color: #6C5CE7; margin: 10px 0; }
        #res-desc { text-align: left; line-height: 1.7; color: #555; font-size: 0.95rem; }
        .celebs-tag { background: #F8F9FA; padding: 10px; border-radius: 10px; margin-top: 15px; font-size: 0.85rem; }

        #final-image-wrapper img { width: 100%; border-radius: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-top: 10px; }
        .btn { padding: 12px 25px; border-radius: 50px; border: none; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-primary { background: #6C5CE7; color: white; }
        .btn-secondary { background: #eee; color: #666; }
    </style>
</head>
<body>

<div id="mbti-app" class="mbti-container">
    <div id="quiz-intro" class="quiz-step">
        <h2 style="color:#6C5CE7; text-align: center;">MBTI æ€§æ ¼å‚¾å‘æ¸¬é©—</h2>
        <p style="text-align: center; color: #666;">æ¢ç´¢ä½ çš„å…§åœ¨æ ¸å¿ƒï¼Œç™¼ç¾ä½ çš„éˆé­‚è‰²å½©ã€‚</p>
        <div style="text-align: center; margin: 30px 0;">
            <button class="btn btn-primary" style="padding: 15px 50px;" onclick="startQuiz()">é–‹å§‹æ·±åº¦æ¸¬é©—</button><br><br>
            <button class="btn btn-secondary" onclick="goHome()">è¿”å›é¦–é </button>
        </div>
        <div style="text-align: center; font-size: 0.8rem; color: #bbb;">ğŸ“ 60 é¡Œ | â± 5 åˆ†é˜</div>
    </div>

    <div id="quiz-content" class="quiz-step" style="display:none;">
        <div class="quiz-top">
            <div class="progress-box"><div id="progress-bar"></div></div>
            <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: #aaa;">
                <span onclick="confirmExit()" style="cursor:pointer; padding: 5px;"><i class="fa-solid fa-xmark"></i> æ”¾æ£„æ¸¬é©—</span>
                <span id="progress-text">0 / 60</span>
            </div>
        </div>
        <h3 id="q-text" style="text-align: center; margin: 30px 0; min-height: 60px;">é¡Œç›®è¼‰å…¥ä¸­...</h3>
        <div class="options-container">
            <button class="opt-btn opt-agree-3" onclick="handleAnswer(3)">éå¸¸åŒæ„</button>
            <button class="opt-btn opt-agree-2" onclick="handleAnswer(2)">åŒæ„</button>
            <button class="opt-btn opt-agree-1" onclick="handleAnswer(1)">ç¨å¾®åŒæ„</button>
            <button class="opt-btn opt-neutral" onclick="handleAnswer(0)">ä¸­ç«‹</button>
            <button class="opt-btn opt-disagree-1" onclick="handleAnswer(-1)">ç¨å¾®ä¸åŒæ„</button>
            <button class="opt-btn opt-disagree-2" onclick="handleAnswer(-2)">ä¸åŒæ„</button>
            <button class="opt-btn opt-disagree-3" onclick="handleAnswer(-3)">éå¸¸ä¸åŒæ„</button>
        </div>
        
        <div style="display: flex; justify-content: center; gap: 20px; margin-top: 30px; border-top: 1px dashed #eee; padding-top: 20px;">
            <button id="prev-btn" onclick="prevQuestion()" style="display:none; color: #888; background: none; border: none; cursor: pointer; font-size: 0.9rem;">
                <i class="fa-solid fa-arrow-left"></i> ä¸Šä¸€é¡Œ
            </button>
            <button onclick="confirmExit()" style="color: #888; background: none; border: none; cursor: pointer; font-size: 0.9rem;">
                <i class="fa-solid fa-house"></i> å›é¦–é 
            </button>
        </div>
    </div>

    <div id="result-page" class="quiz-step" style="display:none;">
        <div id="capture-area">
            <div class="result-card-design">
                <h1 id="res-code">----</h1>
                <h2 id="res-name">äººæ ¼ç¨±è™Ÿ</h2>
                <div id="res-desc"></div>
                <div class="celebs-tag"><strong>ä»£è¡¨äººç‰©ï¼š</strong> <span id="res-celebs"></span></div>
                <div style="font-size: 10px; color:#ccc; margin-top: 15px;">å°é‚¦æ‰‹å¿ƒç†æ¸¬é©— | 2026 ç‰ˆ</div>
            </div>
        </div>
        <div id="final-image-wrapper"></div>
        <p style="text-align: center; color:#6C5CE7; font-weight: bold;">ğŸ’¡ é•·æŒ‰ä¸Šæ–¹åœ–ç‰‡å³å¯å¦å­˜å ±å‘Š</p>
        <div style="display: flex; gap: 10px; justify-content: center;">
            <button class="btn btn-secondary" onclick="location.reload()">é‡æ–°æ¸¬é©—</button>
            <button class="btn btn-primary" onclick="goHome()">è¿”å›é¦–é </button>
        </div>
    </div>
</div>

<script>
// --- è³‡æ–™åº«ï¼š60 é¡Œé¡Œç›® ---
const mbtiQuestions = [
    { text: "åœ¨ç¤¾äº¤èšæœƒä¸­ï¼Œä½ é€šå¸¸æ˜¯ä¸»å‹•æ‰¾äººäº¤è«‡çš„é‚£ä¸€ä½ã€‚", dim: "EI", dir: 1 },
    { text: "å³ä½¿æ˜¯åœ¨ç†±é¬§çš„å ´åˆå¾…ä¸Šä¸€æ•´å¤©ï¼Œä½ ä¾ç„¶æ„Ÿåˆ°ç²¾åŠ›å……æ²›ã€‚", dim: "EI", dir: 1 },
    { text: "ä½ æ›´å–œæ­¡åœ¨å®‰éœã€ç§å¯†çš„ç’°å¢ƒä¸‹å·¥ä½œï¼Œè€Œä¸æ˜¯é–‹æ”¾å¼çš„è¾¦å…¬å®¤ã€‚", dim: "EI", dir: -1 },
    { text: "ç•¶ä½ éœ€è¦æ”¾é¬†æ™‚ï¼Œèˆ‡æœ‹å‹èšæœƒé€šå¸¸æ¯”ç¨è‡ªçœ‹æ›¸æ›´æœ‰æ•ˆã€‚", dim: "EI", dir: 1 },
    { text: "ä½ å–œæ­¡æˆç‚ºç¾¤çœ¾çŸšç›®çš„ç„¦é»ã€‚", dim: "EI", dir: 1 },
    { text: "åœ¨æ‰“é›»è©±ä¹‹å‰ï¼Œä½ é€šå¸¸æœƒå…ˆåœ¨è…¦ä¸­æ¼”ç·´ä¸€éè¦èªªçš„è©±ã€‚", dim: "EI", dir: -1 },
    { text: "åƒåŠ ç¤¾äº¤æ´»å‹•å¾Œï¼Œä½ é€šå¸¸æœƒæ„Ÿåˆ°ç²¾ç–²åŠ›ç«­ï¼Œéœ€è¦æ™‚é–“ç¨è™•ã€‚", dim: "EI", dir: -1 },
    { text: "ä½ åœ¨åœ˜é«”è¨è«–ä¸­å¾€å¾€èƒ½å¾ˆå¿«åœ°ç™¼è¡¨æ„è¦‹ã€‚", dim: "EI", dir: 1 },
    { text: "ä½ å‚¾å‘æ–¼å…ˆè¡Œå‹•å†æ€è€ƒï¼Œè€Œä¸æ˜¯å…ˆæ€è€ƒå†è¡Œå‹•ã€‚", dim: "EI", dir: 1 },
    { text: "å°ä½ ä¾†èªªï¼Œèªè­˜æ–°æœ‹å‹æ˜¯ä¸€ä»¶è¼•é¬†ä¸”ä»¤äººèˆˆå¥®çš„äº‹ã€‚", dim: "EI", dir: 1 },
    { text: "ä½ ä¸ä»‹æ„æˆç‚ºä¸€å€‹å¤§å‹é …ç›®çš„é ˜å°è€…æˆ–ç™¼è¨€äººã€‚", dim: "EI", dir: 1 },
    { text: "ä½ é€šå¸¸æ›´å–œæ­¡æ·±å±¤çš„ä¸€å°ä¸€å°è©±ï¼Œè€Œä¸æ˜¯å¤šäººçš„å°å‹å¯’æš„ã€‚", dim: "EI", dir: -1 },
    { text: "ä½ æ›´å°ˆæ³¨æ–¼ç•¶ä¸‹çš„ç¾å¯¦æƒ…æ³ï¼Œè€Œéæœªä¾†çš„å¯èƒ½æ€§ã€‚", dim: "SN", dir: 1 },
    { text: "ä½ å–œæ­¡ç ”ç©¶æŠ½è±¡çš„æ¦‚å¿µå’Œç†è«–ã€‚", dim: "SN", dir: -1 },
    { text: "è™•ç†å…·é«”çš„æ•¸æ“šå’Œäº‹å¯¦æ¯”æ€è€ƒæœªä¾†çš„è—åœ–æ›´è®“ä½ æ„Ÿåˆ°è¸å¯¦ã€‚", dim: "SN", dir: 1 },
    { text: "ä½ ç¶“å¸¸é™·å…¥æ²‰æ€ï¼Œä»¥è‡³æ–¼å¿½è¦–äº†å‘¨åœç™¼ç”Ÿçš„äº‹æƒ…ã€‚", dim: "SN", dir: -1 },
    { text: "åœ¨åŸ·è¡Œä»»å‹™æ™‚ï¼Œä½ åå¥½éµå¾ªç¶“éé©—è­‰çš„å‚³çµ±æ–¹æ³•ã€‚", dim: "SN", dir: 1 },
    { text: "ä½ ç¶“å¸¸æœƒå»æ€è€ƒã€Œå¦‚æœ...æœƒæ€æ¨£ã€é€™é¡çš„å‡è¨­æ€§å•é¡Œã€‚", dim: "SN", dir: -1 },
    { text: "ä½ èªç‚ºå…·å‚™å¸¸è­˜æ¯”æ“æœ‰éäººçš„æƒ³åƒåŠ›æ›´é‡è¦ã€‚", dim: "SN", dir: 1 },
    { text: "ä½ æ›´å–œæ­¡é–±è®€æ–‡å­¸åè‘—æˆ–ç§‘å¹»ä½œå“ï¼Œè€Œä¸æ˜¯å¯«å¯¦çš„æ–°èå ±å°ã€‚", dim: "SN", dir: -1 },
    { text: "å°ä½ ä¾†èªªï¼Œäº‹æƒ…çš„ç´°ç¯€å¾€å¾€æ¯”æ•´é«”çš„è¼ªå»“æ›´å¸å¼•ä½ ã€‚", dim: "SN", dir: 1 },
    { text: "ä½ æ“…é•·åœ¨çœ‹ä¼¼ç„¡é—œçš„äº‹ç‰©ä¹‹é–“ç™¼ç¾éš±è—çš„è¯çµã€‚", dim: "SN", dir: -1 },
    { text: "ä½ åå‘æ–¼å‹™å¯¦åœ°è§£æ±ºå•é¡Œï¼Œè€Œä¸æ˜¯å°‹æ±‚å‰µæ–°çš„çªç ´ã€‚", dim: "SN", dir: 1 },
    { text: "ä½ ç¶“å¸¸æœƒå¤¢æƒ³è‘—æœªä¾†å„ç¨®å¯èƒ½ç™¼ç”Ÿçš„é©šäººæ”¹è®Šã€‚", dim: "SN", dir: -1 },
    { text: "åœ¨åšæ±ºå®šæ™‚ï¼Œä½ èªç‚ºé‚è¼¯åˆ†ææ¯”æƒ…æ„Ÿè€ƒé‡æ›´é‡è¦ã€‚", dim: "TF", dir: 1 },
    { text: "ä½ éå¸¸åœ¨æ„ä»–äººçš„æ„Ÿå—ï¼Œå„˜ç®¡æœ‰æ™‚é€™æœƒå½±éŸ¿ä½ çš„åˆ¤æ–·ã€‚", dim: "TF", dir: -1 },
    { text: "åœ¨çˆ­è«–ä¸­ï¼Œä½ æ›´åœ¨ä¹èª°æ‰æ˜¯äº‹å¯¦ä¸Šçš„æ­£ç¢ºï¼Œè€Œä¸æ˜¯èª°æœƒå—å‚·ã€‚", dim: "TF", dir: 1 },
    { text: "ä½ é€šå¸¸æœƒç‚ºäº†ç¶­æŒåœ˜é«”çš„å’Œè«§è€Œåšå‡ºè®“æ­¥ã€‚", dim: "TF", dir: -1 },
    { text: "ä½ èªç‚ºä¸€å€‹å¥½çš„æ±ºç­–æ‡‰è©²æ˜¯å®¢è§€ä¸”ä¸åä¸å€šçš„ã€‚", dim: "TF", dir: 1 },
    { text: "ä½ å¾ˆå®¹æ˜“è¢«æ„Ÿäººçš„é›»å½±æˆ–æ•…äº‹è§¸å‹•è€Œæµæ·šã€‚", dim: "TF", dir: -1 },
    { text: "æœ‹å‹æ‰¾ä½ å‚¾è¨´æ™‚ï¼Œä½ é€šå¸¸æœƒå…ˆæä¾›è§£æ±ºå»ºè­°ï¼Œè€Œä¸æ˜¯æƒ…æ„Ÿå®‰æ…°ã€‚", dim: "TF", dir: 1 },
    { text: "ä½ èªç‚ºè¿½æ±‚çœŸç†æ¯”ä¿æŒåœ“æ»‘çš„äººéš›é—œä¿‚æ›´ç‚ºé‡è¦ã€‚", dim: "TF", dir: 1 },
    { text: "ä½ åœ¨åšé‡è¦æ±ºå®šå‰ï¼Œæœƒåè¦†æ€è€ƒé€™å°å…¶ä»–äººæœƒç”¢ç”Ÿä»€éº¼å½±éŸ¿ã€‚", dim: "TF", dir: -1 },
    { text: "ä½ é€šå¸¸è¢«èªç‚ºæ˜¯ä¸€å€‹å†·éœã€ç†æ€§ç”šè‡³æœ‰é»å†·é…·çš„äººã€‚", dim: "TF", dir: 1 },
    { text: "ä½ å¾ˆé›£æ‹’çµ•ä»–äººçš„è«‹æ±‚ï¼Œå› ç‚ºä½ å®³æ€•è®“å°æ–¹å¤±æœ›ã€‚", dim: "TF", dir: -1 },
    { text: "ä½ èªç‚ºéµå®ˆè¦å‰‡èˆ‡å…¬å¹³åŸå‰‡ï¼Œæ¯”çµ¦äºˆå€‹æ¡ˆç‰¹æ®ŠåŒæƒ…æ›´é‡è¦ã€‚", dim: "TF", dir: 1 },
    { text: "åœ¨æ—…è¡Œå‰ï¼Œä½ é€šå¸¸æœƒåˆ¶å®šè©³ç´°çš„è¡Œç¨‹è¨ˆç•«ã€‚", dim: "JP", dir: 1 },
    { text: "ä½ å–œæ­¡ä¿ç•™éˆæ´»çš„å½ˆæ€§ï¼Œä¸å–œæ­¡æŠŠæ™‚é–“è¡¨æ’å¾—å¤ªæ­»ã€‚", dim: "JP", dir: -1 },
    { text: "çœ‹åˆ°æ±è¥¿äº‚æ”¾æˆ–ç’°å¢ƒæ··äº‚æ™‚ï¼Œä½ æœƒæ„Ÿåˆ°ç„¦æ…®ã€‚", dim: "JP", dir: 1 },
    { text: "ä½ ç¶“å¸¸ç­‰åˆ°æœ€å¾Œä¸€åˆ»æˆªæ­¢æ—¥æœŸå¿«åˆ°äº†ï¼Œæ‰é–‹å§‹å…¨åŠ›è¡åˆºã€‚", dim: "JP", dir: -1 },
    { text: "ä½ çš„å·¥ä½œç©ºé–“èˆ‡é›»è…¦æª”æ¡ˆé€šå¸¸æ•´é½ŠåŠƒä¸€ã€äº•ç„¶æœ‰åºã€‚", dim: "JP", dir: 1 },
    { text: "ä½ æ›´å–œæ­¡éš¨æ€§è€Œè‡³çš„å†’éšªï¼Œè€Œä¸æ˜¯æŒ‰éƒ¨å°±ç­çš„å®‰æ’ã€‚", dim: "JP", dir: -1 },
    { text: "ä½ å‚¾å‘æ–¼åœ¨é–‹å§‹ä¸€é …æ–°ä»»å‹™å‰ï¼Œå…ˆæŠŠæ‰€æœ‰çš„æ­¥é©Ÿéƒ½æƒ³å¥½ã€‚", dim: "JP", dir: 1 },
    { text: "ä½ èªç‚ºã€Œè¨ˆç•«è¶•ä¸ä¸Šè®ŠåŒ–ã€ï¼Œæ‰€ä»¥æ²’å¿…è¦è¨­å®šå¤ªåš´å¯†çš„ç›®æ¨™ã€‚", dim: "JP", dir: -1 },
    { text: "å®Œæˆä¸€ä»¶æ¸…å–®ä¸Šçš„ä»»å‹™æœƒè®“ä½ æ„Ÿåˆ°å·¨å¤§çš„æ»¿è¶³æ„Ÿã€‚", dim: "JP", dir: 1 },
    { text: "ä½ ç¶“å¸¸åœ¨ä¸åŒçš„ä»»å‹™ä¹‹é–“è·³ä¾†è·³å»ï¼Œè€Œä¸æ˜¯å°ˆæ³¨å®Œæˆä¸€é …å†åšä¸‹ä¸€é …ã€‚", dim: "JP", dir: -1 },
    { text: "ä½ ä¸å–œæ­¡é©šå–œï¼Œæ›´å¸Œæœ›äº‹æƒ…æŒ‰ç…§é æœŸçš„æ–¹å‘ç™¼å±•ã€‚", dim: "JP", dir: 1 },
    { text: "ä½ èªç‚ºç”Ÿæ´»æ‡‰è©²æ˜¯å……æ»¿è‡ªç™¼æ€§çš„ï¼Œè€Œä¸æ˜¯è¢«å„ç¨®è¦çŸ©æŸç¸›ã€‚", dim: "JP", dir: -1 },
    { text: "é¢å°çªç™¼çš„å·¨å¤§å£“åŠ›ï¼Œä½ é€šå¸¸èƒ½ä¿æŒå†·éœä¸”æƒ…ç·’ç©©å®šã€‚", dim: "AT", dir: 1 },
    { text: "ä½ ç¶“å¸¸æœƒæ“”å¿ƒè‡ªå·±åšéŒ¯äº†æ±ºå®šæˆ–èªªéŒ¯äº†è©±ã€‚", dim: "AT", dir: -1 },
    { text: "ä½ å°è‡ªå·±çš„èƒ½åŠ›éå¸¸æœ‰ä¿¡å¿ƒï¼Œä¸å¤ªéœ€è¦ä»–äººçš„èªåŒã€‚", dim: "AT", dir: 1 },
    { text: "ä½ æ˜¯ä¸€å€‹å®Œç¾ä¸»ç¾©è€…ï¼Œå¸¸ç‚ºäº†ç´°å°çš„ç‘•ç–µè€Œæ„Ÿåˆ°ç„¦æ…®ã€‚", dim: "AT", dir: -1 },
    { text: "å³ä½¿é‡åˆ°äº†æŒ«æŠ˜ï¼Œä½ ä¹Ÿèƒ½å¾ˆå¿«åœ°é‡æ–°ç«™èµ·ä¾†ã€‚", dim: "AT", dir: 1 },
    { text: "ä½ éå¸¸åœ¨æ„ä»–äººå°ä½ çš„è©•åƒ¹å’Œçœ‹æ³•ã€‚", dim: "AT", dir: -1 },
    { text: "ä½ å¾ˆå°‘æœƒå°éå»ç™¼ç”Ÿçš„äº‹æƒ…æ„Ÿåˆ°éºæ†¾æˆ–å¾Œæ‚”ã€‚", dim: "AT", dir: 1 },
    { text: "ä½ ç¶“å¸¸è¦ºå¾—ç”Ÿæ´»å£“åŠ›è®“ä½ å–˜ä¸éæ°£ã€‚", dim: "AT", dir: -1 },
    { text: "åœ¨ç¤¾äº¤å ´åˆï¼Œä½ é€šå¸¸æ„Ÿåˆ°å¾ˆè‡ªåœ¨ï¼Œä¸æœƒè¦ºå¾—å°·å°¬ã€‚", dim: "AT", dir: 1 },
    { text: "ä½ ç¶“å¸¸åè¦†æ€è€ƒå‰›å‰›èˆ‡ä»–äººçš„å°è©±ï¼Œæ“”å¿ƒè‡ªå·±è¡¨ç¾ä¸ä½³ã€‚", dim: "AT", dir: -1 },
    { text: "ä½ èªç‚ºè‡ªå·±æ˜¯ä¸€å€‹æƒ…ç·’éå¸¸ç©©å®šçš„äººã€‚", dim: "AT", dir: 1 },
    { text: "ä½ å¾ˆå®¹æ˜“å› ç‚ºç”Ÿæ´»ä¸­çš„å°äº‹è€Œæ„Ÿåˆ°ç„¦æ…®æˆ–æŒ«æŠ˜ã€‚", dim: "AT", dir: -1 }
];

// --- è³‡æ–™åº«ï¼š16 å‹äººæ ¼è§£æ ---
const personalityData = {
    "INTJ": { name: "å»ºç¯‰å¸«", desc: "ä½ æ“æœ‰å¼·å¤§çš„æ„å¿—èˆ‡ç¨ç«‹æ€è€ƒèƒ½åŠ›ï¼Œè¿½æ±‚æ•ˆç‡ï¼Œæ˜¯å¤©ç”Ÿçš„æˆ°ç•¥å®¶ã€‚", celebs: "åŸƒéš†Â·é¦¬æ–¯å…‹ã€å°¼é‡‡" },
    "INTP": { name: "é‚è¼¯å­¸å®¶", desc: "ä½ å°ç†è«–æœ‰è‘—ä¸æ‡ˆç†±æƒ…ï¼Œæ¯”èµ·ç¾å¯¦ï¼Œä½ æ›´æ´»åœ¨æ¦‚å¿µä¸–ç•Œä¸­ã€‚", celebs: "æ¯”çˆ¾Â·è“‹èŒ²ã€æ„›å› æ–¯å¦" },
    "ENTJ": { name: "æŒ‡æ®å®˜", desc: "å…·å‚™å¼·å¤§é ˜å°åŠ›èˆ‡é è¦‹ï¼Œèƒ½è¿…é€Ÿæœæ–·åœ°å¸¶é ˜åœ˜éšŠé”æˆç›®æ¨™ã€‚", celebs: "è³ˆä¼¯æ–¯ã€æ’’åˆ‡çˆ¾å¤«äºº" },
    "ENTP": { name: "è¾¯è«–å®¶", desc: "è…¦ä¸­å……æ»¿æ–°ç©é»å­ï¼Œå–œæ­¡æŒ‘æˆ°ç¾ç‹€ï¼Œåœ¨ç¢°æ’ä¸­å°‹æ±‚å‰µæ–°ã€‚", celebs: "è‰¾è¿ªç”Ÿã€é‹¼éµäºº" },
    "INFJ": { name: "æå€¡è€…", desc: "å®‰éœè€Œæ·±æ²‰çš„ç†æƒ³ä¸»ç¾©è€…ï¼Œæ“æœ‰æ•éŠ³æ´å¯ŸåŠ›ï¼Œæ¸´æœ›æ”¹è®Šä¸–ç•Œã€‚", celebs: "é¦¬ä¸è·¯å¾·é‡‘ã€æŸæ‹‰åœ–" },
    "INFP": { name: "èª¿è§£è€…", desc: "æº«æŸ”å¯Œæœ‰åŒç†å¿ƒçš„å¤¢æƒ³å®¶ï¼Œå …å®ˆå…§åœ¨åƒ¹å€¼ï¼Œå°‹æ‰¾ç”Ÿæ´»æ„ç¾©ã€‚", celebs: "èå£«æ¯”äºã€JKç¾…ç³" },
    "ENFJ": { name: "ä¸»äººå…¬", desc: "å……æ»¿æ„ŸæŸ“åŠ›çš„é ˜è¢–ï¼Œå–„æ–¼é¼“èˆäººå¿ƒï¼Œå¸¶é ˜å¤§çœ¾èµ°å‘å’Œè«§ã€‚", celebs: "æ­æ™®æ‹‰ã€æ­å·´é¦¬" },
    "ENFP": { name: "ç«¶é¸è€…", desc: "è‡ªç”±å¥”æ”¾çš„éˆé­‚ï¼Œå°ç”Ÿæ´»å……æ»¿å¥½å¥‡ï¼Œæ“…é•·æ¿€ç™¼ä»–äººæ½›èƒ½ã€‚", celebs: "è¿ªå£«å°¼ã€å°å‹å‹ƒé“å°¼" },
    "ISTJ": { name: "ç‰©æµå¸«", desc: "å‹™å¯¦å¯é ï¼Œè²¬ä»»æ„Ÿå¼·ã€‚é‡è¦–ç§©åºèˆ‡å‚³çµ±ï¼Œæ˜¯ç¤¾æœƒçš„ä¸­æµç ¥æŸ±ã€‚", celebs: "å‚‘å¤«è²ä½æ–¯ã€è¯ç››é “" },
    "ISFJ": { name: "å®ˆè­·è€…", desc: "æº«å’Œå …æ¯…ï¼Œç¸½æ˜¯é»˜é»˜é—œæ‡·ä»–äººï¼Œç´°å¿ƒç¶­è­·å‘¨åœäººçš„ç¦ç¥‰ã€‚", celebs: "å¾·è•¾èä¿®å¥³ã€å‡±ç‰¹ç‹å¦ƒ" },
    "ESTJ": { name: "ç¸½ç®¡", desc: "å‚‘å‡ºçš„çµ„ç¹”è€…ï¼Œæ³¨é‡äº‹å¯¦èˆ‡è¦å‰‡ï¼ŒåŸ·è¡ŒåŠ›æ¥µé«˜ä¸”äº•ç„¶æœ‰åºã€‚", celebs: "æ´›å…‹è²å‹’ã€å¸Œæ‹‰è•Š" },
    "ESFJ": { name: "åŸ·æ”¿å®˜", desc: "ç†±æƒ…å‹å¥½çš„ç¤¾äº¤å°ˆå®¶ï¼Œé‡è¦–å’Œè«§ï¼Œæ˜¯å»ºç«‹ç¤¾å€è¯çµçš„é—œéµã€‚", celebs: "æ³°å‹’çµ²ã€ä¼‘å‚‘å…‹æ›¼" },
    "ISTP": { name: "é‘‘è³å®¶", desc: "å†·éœä¸”å……æ»¿å¥½å¥‡å¿ƒï¼Œå–œæ­¡å‹•æ‰‹è§£æ±ºå•é¡Œï¼Œé©æ‡‰èƒ½åŠ›æ¥µå¼·ã€‚", celebs: "éº¥å¯å–¬ä¸¹ã€å°ç¬¬å®‰ç´ç“Šæ–¯" },
    "ISFP": { name: "è—è¡“å®¶", desc: "ä½èª¿ä¸”å¯Œæœ‰ç¾æ„Ÿï¼Œç†±æ„›æ„Ÿå®˜é«”é©—ï¼Œç”¨ç¨ç‰¹æ–¹å¼è¡¨é”æ„Ÿå—ã€‚", celebs: "èŠæ˜‚ç´å¤šã€è‰¾è–‡å…’" },
    "ESTP": { name: "ä¼æ¥­å®¶", desc: "å……æ»¿æ´»åŠ›çš„å†’éšªå®¶ï¼Œæ´»åœ¨ç•¶ä¸‹ï¼Œå°æ©Ÿæœƒæ•éŠ³ï¼Œåœ¨è¡Œå‹•ä¸­å­¸ç¿’ã€‚", celebs: "å·æ™®ã€ç‘ªä¸¹å¨œ" },
    "ESFP": { name: "è¡¨æ¼”è€…", desc: "å¤©ç”Ÿè¡¨æ¼”è€…ï¼Œå……æ»¿æ¨‚è¶£ï¼Œèƒ½é»ç‡ƒæ°£æ°›ï¼Œè®“ç•¶ä¸‹è®Šå¾—ç²¾å½©ã€‚", celebs: "è‰¾çˆ¾é “å¼·ã€ç‘ªéº—è“®å¤¢éœ²" }
};

// --- æ ¸å¿ƒé‚è¼¯ ---
let currentIdx = 0;
let userScores = { EI: 0, SN: 0, TF: 0, JP: 0, AT: 0 };
let scoreHistory = []; // æ–°å¢ï¼šè¨˜éŒ„æ¯ä¸€é¡Œçš„å¾—åˆ†ç´€éŒ„

function startQuiz() {
    currentIdx = 0;
    userScores = { EI: 0, SN: 0, TF: 0, JP: 0, AT: 0 };
    scoreHistory = [];
    document.getElementById('quiz-intro').style.display = 'none';
    document.getElementById('quiz-content').style.display = 'block';
    renderQuestion();
}

function renderQuestion() {
    const q = mbtiQuestions[currentIdx];
    document.getElementById('q-text').innerText = q.text;
    const progress = ((currentIdx + 1) / mbtiQuestions.length) * 100;
    document.getElementById('progress-bar').style.width = progress + "%";
    document.getElementById('progress-text').innerText = `${currentIdx + 1} / ${mbtiQuestions.length}`;
    
    // ç¬¬ä¸€é¡Œä¸é¡¯ç¤ºã€Œä¸Šä¸€é¡Œã€æŒ‰éˆ•
    document.getElementById('prev-btn').style.display = currentIdx > 0 ? "inline-block" : "none";
}

function handleAnswer(value) {
    const q = mbtiQuestions[currentIdx];
    const points = value * q.dir;
    
    // ç´€éŒ„æœ¬æ¬¡å¾—åˆ†
    scoreHistory.push({ dim: q.dim, points: points });
    userScores[q.dim] += points;

    currentIdx++;
    if (currentIdx < mbtiQuestions.length) {
        renderQuestion();
    } else {
        calculateFinalResult();
    }
}

// æ–°å¢ï¼šä¸Šä¸€é¡ŒåŠŸèƒ½
function prevQuestion() {
    if (currentIdx > 0) {
        currentIdx--;
        const lastScore = scoreHistory.pop();
        userScores[lastScore.dim] -= lastScore.points;
        renderQuestion();
    }
}

function calculateFinalResult() {
    let mbti = "";
    mbti += userScores.EI >= 0 ? "E" : "I";
    mbti += userScores.SN >= 0 ? "S" : "N";
    mbti += userScores.TF >= 0 ? "T" : "F";
    mbti += userScores.JP >= 0 ? "J" : "P";
    const identity = userScores.AT >= 0 ? "A" : "T";
    showResultPage(`${mbti}-${identity}`);
}

function showResultPage(code) {
    document.getElementById('quiz-content').style.display = 'none';
    document.getElementById('result-page').style.display = 'block';
    const baseCode = code.split('-')[0];
    const data = personalityData[baseCode];

    document.getElementById('res-code').innerText = code;
    document.getElementById('res-name').innerText = data.name;
    document.getElementById('res-desc').innerHTML = `<p>${data.desc}</p>`;
    document.getElementById('res-celebs').innerText = data.celebs;

    const captureArea = document.getElementById('capture-area');
    setTimeout(() => {
        html2canvas(captureArea, { backgroundColor: "#ffffff", scale: 2 }).then(canvas => {
            const imgData = canvas.toDataURL("image/png");
            const finalImg = document.createElement('img');
            finalImg.src = imgData;
            const wrapper = document.getElementById('final-image-wrapper');
            wrapper.innerHTML = "";
            wrapper.appendChild(finalImg);
            captureArea.style.display = "none"; 
        });
    }, 600);
}

function goHome() { location.href = 'index.html'; }

// ä¿®æ”¹ï¼šå¢åŠ æ¸¬é©—ä¸­çš„èª¤è§¸åˆ¤æ–·
function confirmExit() { 
    if (currentIdx > 0) {
        if (confirm("æ¸¬é©—æ­£åœ¨é€²è¡Œä¸­ï¼Œç¾åœ¨é›¢é–‹å°‡ä¸æœƒä¿ç•™é€²åº¦ã€‚ç¢ºå®šè¦è¿”å›é¦–é å—ï¼Ÿ")) {
            goHome();
        }
    } else {
        goHome();
    }
}
</script>

</body>
</html>

